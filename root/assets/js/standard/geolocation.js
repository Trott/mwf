mwf.touch.geolocation=new function(){var c={GENERAL:"Geolocation failure.",NO_SUPPORT:"No geolocation support available.",PERMISSION_DENIED:"Geolocation permission not granted."};var b={NO_SUPPORT:{code:2,message:c.NO_SUPPORT,PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3}};var d=-1;var a=null;var f=true;var e=3000;var g=5000;this.getType=function(){if(d<0){d=navigator.geolocation?1:typeof google!="undefined"&&google.gears?2:0}return d};this.getTypeName=function(){switch(this.getType()){case 1:return"HTML5 Geolocation";case 2:return"Google Gears";default:return"Unsupported"}};this.getApi=function(){switch(this.getType()){case 1:return navigator.geolocation;case 2:return google.gears.factory.create("beta.geolocation");default:return null}};this.isSupported=function(){return this.getType()>0};this.getPosition=function(j,h){var i=this.getApi();if(i===null){if(typeof h!="undefined"){h(c.NO_SUPPORT)}return}i.getCurrentPosition(function(k){if(typeof j!="undefined"){j({latitude:k.coords.latitude,longitude:k.coords.longitude,accuracy:k.coords.accuracy})}},function(k){if(typeof h!="undefined"){var l=k.code==k.PERMISSION_DENIED?c.PERMISSION_DENIED:c.GENERAL;h(l)}},{enableHighAccuracy:f,maximumAge:e,timeout:g});return};this.getCurrentPosition=function(j,h){var i=this.getApi();if(i===null){if(typeof h=="function"){h(b.NO_SUPPORT)}return}i.getCurrentPosition(function(k){if(typeof j=="function"){j({latitude:k.coords.latitude,longitude:k.coords.longitude,accuracy:k.coords.accuracy})}},function(k){if(typeof h=="function"){h(k)}},{enableHighAccuracy:f,maximumAge:e,timeout:g});return};this.watchPosition=function(k,i){var j=this.getApi();if(!j){if(typeof i=="function"){i(b.NO_SUPPORT)}return}var h=j.watchPosition(function(l){k&&k({latitude:l.coords.latitude,longitude:l.coords.latitude,accuracy:l.coords.accuracy})},function(l){if(typeof i=="function"){i(l)}},{enableHighAccuracy:f,maximumAge:e,timeout:g});return h};this.clearWatch=function(h){var i=this.getApi();if(i!==null){i.clearWatch(h)}};this.setTimeout=function(h){e=h};this.setHighAccuracy=function(h){f=h}};